<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#111827" />
  <title>語り場ニュース</title>

  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="stylesheet" href="./styles.css?v=9" />
</head>
<body>
  <div class="app">

    <!-- Topbar -->
    <header class="topbar">
      <div class="brand">
        <div class="brand__dot" aria-hidden="true"></div>
        <div>
          <div class="brand__name">語り場ニュース</div>
          <div class="brand__sub">限定配信</div>
        </div>
      </div>

      <div style="display:flex; gap:8px; align-items:center;">
        <button class="iconbtn" id="btnExport" aria-label="Export JSON" title="Export">
          <!-- download icon -->
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"/>
          </svg>
        </button>

        <button class="iconbtn" id="btnHelp" aria-label="Help" title="Help">
          <!-- info icon -->
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10
                   10-4.48 10-10S17.52 2 12 2zm0 17c-.55 0-1-.45-1-1s.45-1 1-1
                   1 .45 1 1-.45 1-1 1zm1.07-7.75-.9.92C11.45 12.9 11 13.5 11 15h2v-.5
                   c0-.55.45-1 1-1l1.2-1.2c.37-.37.6-.88.6-1.45 0-1.1-.9-2-2-2
                   -.83 0-1.54.5-1.85 1.22l-1.8-.78C10.63 7.82 12.14 6.5 14 6.5
                   c2.21 0 4 1.79 4 4 0 .88-.36 1.68-.93 2.25z"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Home Page -->
    <main class="page page--active" data-page="home">
      <!-- Search -->
      <section class="search">
        <div class="search__box">
          <div class="search__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.47 6.47 0 0 0 16 9.5
              6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49
              19l-4.99-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5
              11.99 14 9.5 14z"/></svg>
          </div>
          <input id="q" type="text" placeholder="検索（例：告知 / 重要 / イベント）" />
          <button class="search__clear" id="btnClear" aria-label="Clear">
            <svg viewBox="0 0 24 24"><path d="M18.3 5.71 12 12l6.3 6.29-1.41
            1.42L12 13.41l-6.89 6.3-1.41-1.42L10.59 12 3.7 5.71 5.11 4.29 12
            10.59l6.89-6.3z"/></svg>
          </button>
        </div>
      </section>

      <!-- Chips -->
      <section class="chips">
        <div class="chips__row" id="chipRow"></div>
      </section>

      <!-- Feed -->
      <section class="feed">
        <div class="feed__meta">
          <div class="feed__title" id="feedTitle">Latest</div>
          <div class="feed__hint" id="feedHint">0件</div>
        </div>
        <div class="cards" id="cards"></div>
      </section>
    </main>

    <!-- Schedule Page -->
    <main class="page" data-page="schedule">
      <section class="pane">
        <div class="pane__head pane__head--row">
          <h2 class="pane__title">スケジュール</h2>
          <div class="toggle">
            <input id="onlyUpcoming" type="checkbox" />
            <span class="toggle__ui"></span>
            <span class="toggle__label">今後のみ</span>
          </div>
        </div>
        <p class="pane__sub">コミュニティ内の予定（例：イベント / 募集締切 / 配信）</p>

        <div class="cal" id="cal"></div>
        <div class="cal__legend" id="calLegend"></div>
        <div class="sched" id="schedList"></div>
      </section>
    </main>

    <!-- Saved Page -->
    <main class="page" data-page="saved">
      <section class="pane">
        <div class="pane__head">
          <h2 class="pane__title">保存</h2>
          <p class="pane__sub">あとで読む記事</p>
        </div>
        <div class="cards" id="savedCards"></div>
        <div class="empty" id="savedEmpty" style="display:none;">
          <div class="empty__icon">🔖</div>
          <div class="empty__title">保存がありません</div>
          <div class="empty__text">記事を開いて「保存」してください。</div>
        </div>
      </section>
    </main>

    <!-- Contact Page -->
    <div class="page" data-page="contact">
  <div class="page__inner">
    <h2>語り場 共同オーナー</h2>

    <div id="ownerList" class="owner-list"></div>

    <hr style="margin:32px 0; opacity:.2;">

    <h2>お問い合わせ</h2>

    <form id="contactForm" class="contact-form">
      <input type="text" id="cName" placeholder="お名前" required>
      <input type="email" id="cEmail" placeholder="メールアドレス" required>
      <textarea id="cMessage" placeholder="お問い合わせ内容" rows="5" required></textarea>
      <button type="submit">送信</button>
    </form>
  </div>
</div>

    <!-- Admin Page -->
    <main class="page" data-page="admin">
      <section class="pane">
        <div class="pane__head pane__head--row">
          <h2 class="pane__title">管理（投稿・編集）</h2>
          <button class="btn" id="btnNewPost">＋ 新規記事</button>
        </div>
        <p class="pane__sub">この端末のlocalStorageに保存されます。運用で共有する場合は Export/Import を使ってください。</p>

        <div class="admin__row">
          <div class="admin__list">
            <div class="admin__listhead">
              <div class="admin__listh">記事一覧</div>
              <div class="admin__listhint" id="adminCount">0件</div>
            </div>
            <div class="admin__items" id="adminItems"></div>
          </div>

          <div class="admin__editor">
            <div class="admin__editorhead">
              <div class="admin__listh">編集</div>
              <div style="display:flex; gap:8px;">
                <button class="btn btn--ghost" id="btnImport">Import</button>
                <button class="btn btn--danger" id="btnDeletePost" disabled>削除</button>
                <button class="btn" id="btnSavePost" disabled>保存</button>
              </div>
            </div>

            <form class="form" id="postForm">
              <div class="grid2">
                <label class="field">
                  <div class="field__label">タイトル</div>
                  <input class="input" id="pTitle" placeholder="例：コミュニティ限定の告知" required />
                </label>

                <label class="field">
                  <div class="field__label">日付</div>
                  <input class="input" id="pDate" type="date" required />
                </label>
              </div>

              <div class="grid2">
                <label class="field">
                  <div class="field__label">チャンネル</div>
                  <select class="input" id="pChannel">
                    <option value="announce">告知</option>
                    <option value="event">イベント</option>
                    <option value="ops">運営</option>
                    <option value="tips">Tips</option>
                  </select>
                </label>

                <label class="field">
                  <div class="field__label">トーン（色）</div>
                  <select class="input" id="pTone">
                    <option value="accent">accent</option>
                    <option value="good">good</option>
                    <option value="warn">warn</option>
                    <option value="danger">danger</option>
                  </select>
                </label>
              </div>

              <label class="field">
                <div class="field__label">短い説明（カードに表示）</div>
                <input class="input" id="pDesc" placeholder="例：締切や参加方法などの要約" />
              </label>

              <label class="field">
                <div class="field__label">タグ（カンマ区切り）</div>
                <input class="input" id="pTags" placeholder="例：固定,Zoom,必読" />
              </label>

              <label class="field">
                <div class="field__label">要点（改行区切り）</div>
                <textarea class="textarea" id="pSummary" rows="4" placeholder="例：&#10;・日時：2/18 20:00&#10;・URLは当日掲示"></textarea>
              </label>

              <label class="field">
                <div class="field__label">本文（改行で段落）</div>
                <textarea class="textarea" id="pBody" rows="8" placeholder="本文を入力"></textarea>
              </label>

              <label class="field">
  <div class="field__label">画像URL（改行で複数）</div>
  <textarea class="textarea" id="pImages" rows="3" placeholder="https://..."></textarea>
</label>

<label class="field">
  <div class="field__label">動画URL（YouTube等 / mp4直リンク）</div>
  <input class="input" id="pVideo" placeholder="https://..." />
</label>

              <div class="grid2">
                <label class="field">
                  <div class="field__label">CTAテキスト（任意）</div>
                  <input class="input" id="pCtaText" placeholder="例：参加フォームへ" />
                </label>

                <label class="field">
                  <div class="field__label">CTA URL（任意）</div>
                  <input class="input" id="pCtaUrl" placeholder="https://..." />
                </label>
              </div>

              <div class="hint">
                ※「保存」を押すと Home に即反映されます（検索/チップにも対応）。
              </div>
            </form>
          </div>
        </div>
      </section>
    </main>

    <!-- Bottom Nav -->
    <nav class="bottomnav" aria-label="Bottom Navigation">
      <button class="navitem navitem--active" data-nav="home" aria-label="Home">
        <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
        <span>Home</span>
      </button>

      <button class="navitem" data-nav="schedule" aria-label="Schedule">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M7 2h2v2h6V2h2v2h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h4V2zm15 8H2v10h20V10zM3 8h18V6H3v2z"/>
        </svg>
        <span>Schedule</span>
      </button>

      <button class="navitem" data-nav="saved" aria-label="Saved">
        <svg viewBox="0 0 24 24"><path d="M6 2h12a2 2 0 0 1 2 2v18l-8-4-8 4V4a2 2 0 0 1 2-2z"/></svg>
        <span>Saved</span>
      </button>

      <button class="navitem" data-nav="contact" aria-label="Contact">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4zm0 2c-4.42 0-8 2-8 4v2h16v-2c0-2-3.58-4-8-4z"/>
    </svg>
    <span>Contact</span>
  </button>

      <button class="navitem" data-nav="admin" aria-label="Admin">
        <!-- pencil icon -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.83H5v-.92l9.06-9.06.92.92L5.92 20.08zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/>
        </svg>
        <span>Admin</span>
      </button>
    </nav>

    <!-- Drawer: Article Detail -->
    <div class="drawer" id="drawer" aria-hidden="true">
      <div class="drawer__scrim" id="drawerScrim"></div>
      <div class="drawer__panel" role="dialog" aria-modal="true" aria-label="Article detail">
        <div class="drawer__top">
          <div class="drawer__meta">
            <span class="badge" id="drawerBadge"><span class="badge__dot"></span><span id="drawerBadgeText">Info</span></span>
            <span class="drawer__date" id="drawerDate">-</span>
          </div>
          <div style="display:flex; gap:8px;">
            <button class="iconbtn" id="btnSave" aria-label="Save">
              <svg viewBox="0 0 24 24"><path d="M6 2h12a2 2 0 0 1 2 2v18l-8-4-8 4V4a2 2 0 0 1 2-2z"/></svg>
            </button>
            <button class="iconbtn" id="btnClose" aria-label="Close">
              <svg viewBox="0 0 24 24"><path d="M18.3 5.71 12 12l6.3 6.29-1.41
                1.42L12 13.41l-6.89 6.3-1.41-1.42L10.59 12 3.7 5.71 5.11 4.29 12
                10.59l6.89-6.3z"/></svg>
            </button>
          </div>
        </div>

        <div class="article">
          <div class="article__hero" id="hero"></div>
          <h2 class="article__title" id="aTitle">-</h2>

          <div class="article__stats" id="aStats"></div>

          <div class="article__summary" id="aSummary">
            <ul id="aSummaryList"></ul>
          </div>

          <div class="article__body" id="aBody"></div>

          <div class="article__footer">
            <div class="cta" id="cta" style="display:none;">
              <div class="cta__text" id="ctaText">リンク</div>
              <a class="cta__btn" id="ctaBtn" href="#" target="_blank" rel="noopener">開く</a>
            </div>
            <div class="muted" id="aMeta"></div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <input id="fileImport" type="file" accept="application/json" style="display:none;" />

  <script src="config.js"></script>
  <script src="./app.js?v=9"></script>
  <!-- serviceWorker 一旦停止（キャッシュ切り分け） -->
<!--
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
  -->
</body>
</html>
